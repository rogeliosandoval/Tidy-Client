<p-dialog header="{{ type === 'add' ? 'Add Client' : 'Edit Client' }}" [modal]="true" (onHide)="closeModal()" [(visible)]="showClientFormDialog" [style]="{ width: '30rem', height: '600px' }">
  <form [formGroup]="clientForm" class="client-form" (ngSubmit)="type === 'add' ? submitModal('add') : submitModal('edit')" [class.form-container-dark]="sharedService.darkMode()">
    <div class="input-group" [class.disabled]="dialogLoading()">
      <label for="client_name">Client Name*</label>
      <input type="text" pInputText variant="filled" placeholder="Name" formControlName="client_name"/>
    </div>

    <div class="input-group" [class.disabled]="dialogLoading()">
      <label for="connected_by">Connected By:</label>
      <p-dropdown [options]="connections()" placeholder="Select Connection" variant="filled" formControlName="connected_by" scrollHeight="235px"/>
    </div>

    <div class="input-group" [class.disabled]="dialogLoading()">
      <label for="client_email">Client Email</label>
      <input type="email" pInputText variant="filled" placeholder="Email" formControlName="client_email"/>
    </div>

    <div class="input-group" [class.disabled]="dialogLoading()">
      <label for="client_phone">Client Phone</label>
      <input type="tel" pInputText variant="filled" placeholder="Phone" formControlName="client_phone" phoneNumber/>
    </div>

    <div class="input-group" [class.disabled]="dialogLoading()">
      <label for="client_location">Client Location</label>
      <input type="text" pInputText variant="filled" placeholder="Location" formControlName="client_location"/>
    </div>

    @if (showUploadAvatarButton()) {
      @if (avatarUrl) {
        <div class="avatar-container" [class.disabled]="dialogLoading()">
          <img class="avatar-preview" [src]="avatarUrl" alt="avatar image preview">
          <i class="pi pi-trash" (click)="avatarUrl = null; "></i>
        </div>
      } @else {
        <div class="custom-id-input" [class.disabled]="dialogLoading()">
          <input type="file" id="avatar" accept="image/*" (change)="avatarUpload($event)">
          <label style="font-size: 0.9rem;" for="avatar" [style.border]="sharedService.darkMode() ? '2px dashed white' : '2px dashed black'"><i class="pi pi-upload"></i>Upload Avatar</label>
        </div>
      }
    } @else {
      <div class="avatar-container" [class.disabled]="dialogLoading()">
        <img class="avatar" src="assets/avatars/default-business-avatar.png" alt="avatar">
        <i class="pi pi-trash" (click)="showUploadAvatarButton.set(true)"></i>
      </div>
    }

    <!-- <div class="contact-container">
      <label>Contacts</label>
      <p-button label="Add Contact" severity="success"></p-button>
    </div>

    <div class="input-group">
      <label for="contact_name">Contact Name</label>
      <input type="text" pInputText variant="filled" placeholder="Name" formControlName="contact_name" [class.disabled]="dialogLoading()"/>
    </div>

    <div class="input-group">
      <label for="contact_email">Contact Email</label>
      <input type="email" pInputText variant="filled" placeholder="Email" formControlName="contact_email" [class.disabled]="dialogLoading()"/>
    </div>

    <div class="input-group">
      <label for="contact_phone">Contact Phone</label>
      <input type="tel" pInputText variant="filled" placeholder="Phone" formControlName="contact_phone" [class.disabled]="dialogLoading()" phoneNumber/>
    </div> -->

    <div class="input-group" [class.disabled]="dialogLoading()">
      <label for="note">Note</label>
      <textarea rows="3" cols="30" pInputTextarea variant="filled" formControlName="note"  placeholder="Add a note or a description for this client" style="resize: none;"></textarea>
    </div>
    <p-button label="{{ type === 'add' ? 'Add Client' : 'Update Client' }}" type="submit" [disabled]="dialogLoading() || clientForm.invalid"></p-button>
    @if (dialogLoading()) {
      <p-progressSpinner ariaLabel="loading" strokeWidth="3"/>
    }
  </form>
</p-dialog>